(()=>{"use strict";const e=window.wp.blocks,t=window.wp.element,a=window.wp.blockEditor,l=window.wp.components,n=[{label:"Football",value:"football"},{label:"Men's Basketball",value:"mensBasketball"},{label:"Women's Basketball",value:"womensBasketball"}],o=(()=>{const e=[{label:"Current Season",value:""}];for(let t=(new Date).getFullYear();t>=2015;t--)e.push({label:`${t}-${t+1}`,value:String(t)});return e})(),s="228",r=(e,t="")=>null==e?t:"object"==typeof e?e.displayValue||e.value||t:String(e),c=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"starter-theme/espn-score","version":"1.0.0","title":"ESPN Game Score","category":"embed","icon":"awards","description":"Embed a Clemson game scoreboard with live scores from ESPN","keywords":["espn","score","game","clemson","sports","football","basketball"],"textdomain":"starter-wp-theme","attributes":{"sport":{"type":"string","default":"football"},"season":{"type":"string","default":""},"gameId":{"type":"string","default":"latest"},"title":{"type":"string","default":""},"nameStyle":{"type":"string","default":"short"}},"supports":{"html":false,"align":["wide","full"],"spacing":{"margin":true,"padding":true}},"editorScript":"file:./index.js","editorStyle":"file:./index.css"}');(0,e.registerBlockType)(c.name,{...c,edit:function({attributes:e,setAttributes:c}){const{sport:m,season:i,gameId:p,title:d,nameStyle:u}=e,[w,b]=(0,t.useState)([]),[g,h]=(0,t.useState)(!1),[v,E]=(0,t.useState)(null),[f,y]=(0,t.useState)(null);(0,t.useEffect)(()=>{_(m,i)},[m,i]),(0,t.useEffect)(()=>{if(w.length>0)if("latest"===p){const e=new Date,t=w.filter(t=>new Date(t.date)<=e),a=t.length>0?t[t.length-1]:w[0];E(a)}else{const e=w.find(e=>e.id===p);E(e||null)}},[p,w]);const _=async(e,t)=>{h(!0),y(null);try{const a=await fetch(((e,t)=>{let a=`https://site.api.espn.com/apis/site/v2/sports/${{football:"football/college-football",mensBasketball:"basketball/mens-college-basketball",womensBasketball:"basketball/womens-college-basketball"}[e]}/teams/${s}/schedule`;return t&&(a+=`?season=${t}`),a})(e,t));if(!a.ok)throw new Error("Failed to fetch games");const l=await a.json(),n=l.events?.map(e=>{const t=e.competitions?.[0];if(!t)return null;const a=t.competitors?.find(e=>String(e.team?.id)===s),l=t.competitors?.find(e=>String(e.team?.id)!==s),n="home"===a?.homeAway,o=a?.team||{},r=l?.team||{};return{id:e.id,date:e.date,name:e.name,shortName:e.shortName,isHome:n,status:e.status,clemson:{id:o.id,displayName:o.displayName,shortDisplayName:o.shortDisplayName,name:o.name,nickname:o.nickname,location:o.location,abbreviation:o.abbreviation,color:o.color,logos:o.logos,logo:o.logo,score:a?.score,record:a?.records?.[0]?.summary,rank:a?.curatedRank?.current},opponent:{id:r.id,displayName:r.displayName,shortDisplayName:r.shortDisplayName,name:r.name,nickname:r.nickname,location:r.location,abbreviation:r.abbreviation,color:r.color,logos:r.logos,logo:r.logo,score:l?.score,record:l?.records?.[0]?.summary,rank:l?.curatedRank?.current},venue:t.venue,broadcasts:t.broadcasts?.[0]?.names||[]}}).filter(Boolean)||[];b(n)}catch(e){console.error("Failed to fetch games:",e),y("Unable to load games. Please try again.")}h(!1)},N=e=>new Date(e).toLocaleDateString("en-US",{month:"numeric",day:"numeric",year:"numeric"}),S=()=>n.find(e=>e.value===m)?.label||"Football",k="football"===m,C=(e,t,a)=>{const l=((e,t)=>t?"#F56600":e?.color?`#${e.color}`:"#333333")(e,t),n=r(e?.rank),o=n&&parseInt(n,10)<=25?n:null,s=r(e?.record),c=r(a,"0"),m=(e=>{if(e?.logo)return e.logo;if(e?.logos?.length>0){const t=e.logos.find(e=>e.rel?.includes("default"));return t?.href?t.href:e.logos[0]?.href}return e?.id?`https://a.espncdn.com/i/teamlogos/ncaa/500/${e.id}.png`:null})(e),i="full"===u?e?.displayName||e?.shortDisplayName||e?.location||"TBD":e?.shortDisplayName||e?.nickname||e?.location||"TBD";return wp.element.createElement("div",{className:"espn-scorecard__team"},m?wp.element.createElement("img",{src:m,alt:`${i} logo`,className:"espn-scorecard__logo"}):wp.element.createElement("div",{className:"espn-scorecard__logo-placeholder",style:{backgroundColor:l}},e?.abbreviation||"?"),wp.element.createElement("div",{className:"espn-scorecard__team-name",style:{color:l}},o&&wp.element.createElement("span",{className:"espn-scorecard__rank"},"#",o," "),i),wp.element.createElement("div",{className:"espn-scorecard__record"},s),"pre"!==v?.status?.type?.state&&void 0!==a&&wp.element.createElement("div",{className:"espn-scorecard__score",style:{color:l}},c))},{awayTeam:D,homeTeam:T,awayScore:$,homeScore:B,awayIsClemson:I,homeIsClemson:P}=v?{awayTeam:v.isHome?v.opponent:v.clemson,homeTeam:v.isHome?v.clemson:v.opponent,awayScore:v.isHome?v.opponent?.score:v.clemson?.score,homeScore:v.isHome?v.clemson?.score:v.opponent?.score,awayIsClemson:!v.isHome,homeIsClemson:v.isHome}:{awayTeam:null,homeTeam:null},F=[{label:"Latest Game (Auto-select)",value:"latest"},...w.map(e=>({label:`${e.isHome?"vs":"@"} ${e.opponent?.displayName||e.opponent?.name||"TBD"} - ${N(e.date)}`,value:e.id}))];return wp.element.createElement(wp.element.Fragment,null,wp.element.createElement(a.InspectorControls,null,wp.element.createElement(l.PanelBody,{title:"Display Settings",initialOpen:!0},wp.element.createElement(l.SelectControl,{label:"Team Name Style",value:u,options:[{label:"Short (e.g., Clemson)",value:"short"},{label:"Full (e.g., Clemson Tigers)",value:"full"}],onChange:e=>c({nameStyle:e}),help:"Choose how team names are displayed"}),wp.element.createElement(l.TextControl,{label:"Custom Title (optional)",value:d,onChange:e=>c({title:e}),placeholder:`Clemson ${S()} Scoreboard`,help:"Leave blank for default title"}))),wp.element.createElement("div",(0,a.useBlockProps)({className:"espn-score-block"}),wp.element.createElement("div",{className:"espn-score-controls"},wp.element.createElement("div",{className:"espn-score-controls__row"},wp.element.createElement("div",{className:"espn-score-controls__field"},wp.element.createElement("label",null,"Sport"),wp.element.createElement(l.SelectControl,{value:m,options:n,onChange:e=>c({sport:e,gameId:"latest"})})),wp.element.createElement("div",{className:"espn-score-controls__field"},wp.element.createElement("label",null,"Season"),wp.element.createElement(l.SelectControl,{value:i,options:o,onChange:e=>c({season:e,gameId:"latest"})})),wp.element.createElement("div",{className:"espn-score-controls__field espn-score-controls__field--wide"},wp.element.createElement("label",null,"Game"),wp.element.createElement(l.SelectControl,{value:p,options:F,onChange:e=>c({gameId:e})})))),g?wp.element.createElement(l.Placeholder,{icon:"awards",label:"ESPN Game Score"},wp.element.createElement(l.Spinner,null),wp.element.createElement("p",null,"Loading games...")):f?wp.element.createElement(l.Placeholder,{icon:"warning",label:"ESPN Game Score"},wp.element.createElement("p",null,f)):v?wp.element.createElement("div",{className:"espn-scorecard"},wp.element.createElement("h2",{className:"espn-scorecard__title"},d||`Clemson ${S()} Scoreboard`),wp.element.createElement("div",{className:"espn-scorecard__content"},C(D,I,$),wp.element.createElement("div",{className:"espn-scorecard__info"},k&&wp.element.createElement(wp.element.Fragment,null,wp.element.createElement("div",{className:"espn-scorecard__period-label"},"QUARTER"),wp.element.createElement("div",{className:"espn-scorecard__dots"},Array.from({length:4}).map((e,t)=>wp.element.createElement("span",{key:t,className:"espn-scorecard__dot "+(v.status?.type?.completed?"":t<(v.status?.period||0)?"espn-scorecard__dot--active":"")})))),wp.element.createElement("div",{className:"espn-scorecard__status"},v.status?.type?.shortDetail||v.status?.type?.description||"Scheduled"),wp.element.createElement("div",{className:"espn-scorecard__date"},N(v.date)),v.venue&&wp.element.createElement(wp.element.Fragment,null,wp.element.createElement("div",{className:"espn-scorecard__venue"},v.venue?.address?.city?.toUpperCase()||""),wp.element.createElement("div",{className:"espn-scorecard__venue"},v.venue?.fullName?.toUpperCase()||"")),v.broadcasts?.length>0&&wp.element.createElement("div",{className:"espn-scorecard__broadcast"},"Watch on: ",wp.element.createElement("span",null,v.broadcasts[0]))),C(T,P,B)),wp.element.createElement("div",{className:"espn-scorecard__border"})):wp.element.createElement(l.Placeholder,{icon:"awards",label:"ESPN Game Score"},wp.element.createElement("p",null,"Select a sport and game to preview the scoreboard."))))},save:function(){return null}})})();